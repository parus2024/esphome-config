addressable_lambda:
  name: Scan Blue Parus
  update_interval: 10ms  # Чаще вызываем для плавности
  lambda: |-
    static int step = 0;
    static int direction = 1;
    static uint32_t last_move = 0;  // Время последнего шага

    // 1. Расчёт интервала движения (зависит от слайдера)
    int speed_value = id(effect_speed).state;  // Значение слайдера (0–255)
    uint32_t move_interval = 500 - (speed_value * 490) / 255;  // 500→10 мс
    move_interval = max(move_interval, (uint32_t)10);  // Минимум 10 мс

    uint32_t current_time = millis();

    // 2. Проверяем, пора ли двигать пиксель
    if (current_time - last_move >= move_interval) {
      // 2.1. Гасим предыдущий пиксель
      if (step >= 0 && step < it.size()) {
        it[step] = Color::BLACK;
      }

      // 2.2. Двигаем позицию
      step += direction;

      // 2.3. Отражение от краёв
      if (step >= it.size()) {
        step = it.size() - 1;
        direction = -1;
      } else if (step < 0) {
        step = 0;
        direction = 1;
      }

      // 2.4. Зажигаем новый пиксель
      it[step] = Color(0, 0, 255);

      // 2.5. Обновляем таймер
      last_move = current_time;
    }
