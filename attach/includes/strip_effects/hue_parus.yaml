addressable_lambda:
  name: "HUE Parus"
  update_interval: 50ms
  lambda: |-
    static float hue = 0.0;  // Начальное значение оттенка

    // Получаем значения со слайдеров
    const uint8_t SPEED = static_cast<uint8_t>(id(effect_speed).state);      // 0–255
    const uint8_t INTENSITY = static_cast<uint8_t>(id(effect_intensity).state); // 0–255

    if (initial_run) {
      ESP_LOGD("effect", "HUE Parus");
    }

    // Нормализуем значения
    float speed = SPEED / 100.0;  // Скорость изменения оттенка: 0.0–0.1 за шаг
    // Корректируем насыщенность: при INTENSITY=0 -> 130/255, при INTENSITY=255 -> 1.0
    float saturation = 130.0 / 255.0 + (INTENSITY / 255.0) * (1.0 - 130.0 / 255.0);
    uint8_t saturation_byte = static_cast<uint8_t>(saturation * 255);  // Преобразуем в байт
    uint8_t brightness = 255;  // Яркость всегда максимальная

    // Обновляем оттенок (hue)
    hue += speed;

    // Применяем цвет ко всем пикселям
    for (int i = 0; i < it.size(); i++) {
      it[i] = ESPHSVColor(hue, saturation_byte, brightness);
    }
